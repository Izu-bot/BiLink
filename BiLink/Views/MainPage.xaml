<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:BiLink.Models"
             xmlns:viewModels="clr-namespace:BiLink.ViewModels"
             x:Class="BiLink.Views.MainPage">

    <Grid RowDefinitions="Auto, *">

        <VerticalStackLayout Grid.Row="0">
            <SearchBar Placeholder="Pesquisar links"
                       Margin="20"
                       BackgroundColor="#1e1e1e" />

            <Grid ColumnDefinitions="*,*,*,Auto" ColumnSpacing="10" Margin="22,10">
                <VerticalStackLayout Grid.Column="0">
                    <Label Text="Link URL" TextColor="White" Margin="4" />
                    <Entry Placeholder="http://exemplo.com" TextColor="White" Text="{Binding Url}"/>
                </VerticalStackLayout>
                <VerticalStackLayout Grid.Column="1">
                    <Label Text="Nome do link" TextColor="White" Margin="4" />
                    <Entry Placeholder="Tênis em promoção" TextColor="White" Text="{Binding Name}"/>
                </VerticalStackLayout>
                <VerticalStackLayout Grid.Column="2">
                    <Label Text="Categoria" TextColor="White" Margin="4" />
                    <Picker x:Name="picker" ItemsSource="{Binding Categorias}" SelectedItem="{Binding Categoria}" />
                </VerticalStackLayout>
            </Grid>

            <Button Text="+ Adicionar" Margin="25, 0, 38 ,0" BackgroundColor="#bcc2d1" TextColor="Black" Command="{Binding AddLinkCommand}"/>

            <Border Margin="10, 30" StrokeThickness="0.3" BackgroundColor="Black"/>

            <Label Text="Seus Links" FontSize="18" FontAttributes="Bold" Margin="10,0" TextColor="White"/>
        </VerticalStackLayout>

        <CollectionView Grid.Row="1"
                ItemsSource="{Binding Links}"
                Margin="6">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:Link">
                    <VerticalStackLayout Spacing="0">
                        <Border StrokeThickness="0.3" 
                        BackgroundColor="#1e1e1e" 
                        Padding="6" 
                        Margin="0, 8" 
                        StrokeShape="RoundRectangle 6" 
                        Shadow="0 2 6 Black 0.4" >
                            <Grid ColumnDefinitions="*,Auto, Auto" >
                                <VerticalStackLayout Grid.Column="0">
                                    <Label Text="{Binding Nome}" FontSize="16" FontAttributes="Bold" TextColor="White" VerticalOptions="Center" Margin="6, 18, 0, 0"/>
                                    <!--<Label Text="{Binding URL}" FontSize="14" TextColor="White"/>-->
                                </VerticalStackLayout>


                                <Button Grid.Column="1"
                                     Text="&#xf0c5;"
                                     BackgroundColor="Transparent"
                                     TextColor="#bcc2d1"
                                     FontSize="18"
                                     FontFamily="FontAwesome"  
                                     Margin="6"
                                     Command="{Binding Source={RelativeSource AncestorType={x:Type viewModels:MainPageViewModel}}, Path=CopyLink}"
                                     CommandParameter="{Binding}"
                                     />


                                <Button Grid.Column="2"
                                     Text="&#xf2ed;"
                                     BackgroundColor="Transparent"
                                     TextColor="#bcc2d1"
                                     FontSize="18"
                                     FontFamily="FontAwesome"  
                                     Margin="6"
                                     Command="{Binding Source={RelativeSource AncestorType={x:Type viewModels:MainPageViewModel}}, Path=DeleteLinkCommand}"
                                     CommandParameter="{Binding .}" />
                            </Grid>
                        </Border>
                    </VerticalStackLayout>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>